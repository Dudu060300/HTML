:root {
  /* Colore di sfondo principale */
  --bg-color: #ffffff;
  /* Colore testo principale */
  --text-color: #000000;
  /* Sfondo principale (può coincidere con bg-color) */
  --main-bg: #ffffff;
  /* Sfondo barra di navigazione */
  --nav-bg: #000000;
  /* Colore testo barra di navigazione */
  --nav-text: #ffffff;
  /* Sfondo popup */
  --popup-bg: #000000;
  /* Colore testo popup */
  --popup-color: #ffffff;
  /* Colore accento (es. bottoni, hover) */
  --accent-color: #00f7ff;
  /* Colore accento per hover */
  --accent-hover: #00c2cc;
  /* Colore messaggi di errore */
  --error-color: #ff4c4c;
  /* Colore messaggi di successo */
  --success-color: #4cff6b;
  /* Colore testo chiaro (bianco) */
  --text-light: #fff;
  /* Colore testo attenuato (grigio chiaro) */
  --text-muted: #bbb;
  /* Sfondo input in sola lettura */
  --input-bg-readonly: #444;
  /* Velocità di transizione per animazioni */
  --transition-speed: 0.3s;
}

/* Tema scuro: sovrascrive alcune variabili */
body.dark {
  --popup-bg: #ffffff;      /* Sfondo popup chiaro */
  --popup-color: #000000;   /* Testo popup scuro */
  --bg-color: #000000;      /* Sfondo pagina scuro */
  --main-bg: #000000;       /* Sfondo principale scuro */
  --nav-bg: #ffffff;        /* Sfondo navbar chiaro */
  --nav-text: #000000;      /* Testo navbar scuro */
  --text-color: #ffffff;    /* Testo principale chiaro */
}

/* Applica box-sizing border-box a tutti gli elementi, così padding e border rientrano nella dimensione totale */
* {
  box-sizing: border-box;
}

/* Overlay semi-trasparente per sfondo modal impostazioni */
#settingsOverlay {
  position: fixed;          /* posizione fissa su tutta la pagina */
  top: 0; left: 0;         /* parte dall'angolo in alto a sinistra */
  width: 100%; height: 100%; /* copre tutta la viewport */
  background: rgba(0, 0, 0, 0.5); /* sfondo nero trasparente */
  z-index: 998;            /* sopra quasi tutto tranne popup */
}

/* Popup centrato per le impostazioni */
#settingsPopup {
  position: fixed;          /* posizione fissa */
  top: 50%; left: 50%;      /* centro verticale e orizzontale */
  transform: translate(-50%, -50%); /* sposta esattamente al centro */
  background: var(--bg-color); /* colore di sfondo variabile */
  color: var(--text-color);     /* colore testo variabile */
  padding: 20px;             /* spazio interno */
  z-index: 999;              /* sopra l'overlay */
  border-radius: 8px;        /* angoli arrotondati */
  min-width: 300px;          /* larghezza minima */
}

/* Stile base per checkbox usato come toggle switch */
input[type="checkbox"][role="switch"] {
  width: 50px;               /* larghezza del toggle */
  height: 24px;              /* altezza del toggle */
  position: relative;        /* per posizionare il pallino interno */
  -webkit-appearance: none;  /* rimuove stile di default */
  background: #c6c6c6;       /* colore di sfondo grigio */
  outline: none;             /* rimuove outline di default */
  border-radius: 12px;       /* angoli arrotondati per forma ovale */
  transition: background 0.3s; /* transizione colore di sfondo */
  cursor: pointer;           /* cursore a mano */
}

/* Pallino interno del toggle */
input[type="checkbox"][role="switch"]::before {
  content: '';               /* elemento vuoto */
  position: absolute;        /* posizione assoluta rispetto al toggle */
  width: 22px;               /* dimensione del pallino */
  height: 22px;
  border-radius: 50%;        /* forma circolare */
  top: 1px;                  /* distanza dal bordo superiore */
  left: 1px;                 /* distanza dal bordo sinistro */
  background: #fff;          /* colore bianco */
  transition: 0.3s;          /* transizione fluida */
  box-shadow: 0 2px 5px rgba(0,0,0,0.2); /* ombra leggera */
}

/* Colore background del toggle quando attivo (checked) */
input[type="checkbox"][role="switch"]:checked {
  background: var(--accent-color); /* colore di accento */
}

/* Sposta il pallino a destra quando toggle è attivo */
input[type="checkbox"][role="switch"]:checked::before {
  transform: translateX(26px);
}

/* Stile base del body */
body {
  margin: 0;                          /* nessun margine */
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; /* font di sistema */
  background: var(--bg-color);        /* colore di sfondo variabile */
  color: var(--text-color);           /* colore testo variabile */
}

/* ===== NAVIGATION ===== */

/* Barra di navigazione principale */
nav {
  display: flex;                      /* flexbox per layout */
  justify-content: space-between;    /* spaziatura tra elementi */
  align-items: center;               /* allinea verticalmente */
  background: var(--nav-bg);          /* colore sfondo nav */
  color: var(--nav-text);             /* colore testo nav */
  padding: 0 20px;                   /* padding orizzontale */
  height: 60px;                      /* altezza nav */
  box-shadow: 0 2px 10px rgba(0,0,0,0.7); /* ombra sotto nav */
  position: sticky;                  /* nav fissa in cima durante scroll */
  top: 0;                           /* posizione top */
  z-index: 10;                      /* sopra altri contenuti */
}

/* Titolo principale della nav */
nav h1 {
  font-weight: 700;                  /* grassetto */
  font-size: 1.5rem;                 /* dimensione font */
}

/* Contenitore menu utente con icona e nome */
.user-menu {
  position: relative;                /* per posizionare dropdown */
  cursor: pointer;                  /* cursore a mano */
  display: flex;                    /* flex layout */
  align-items: center;              /* allineamento verticale */
  gap: 10px;                       /* spazio tra icona e testo */
  user-select: none;               /* impedisce selezione testo */
}

/* Icona utente, forma circolare */
.user-icon {
  width: 40px;                      /* larghezza */
  height: 40px;                     /* altezza */
  background: var(--bg-color);      /* colore sfondo */
  border-radius: 50%;               /* cerchio */
  color: var(--text-color);         /* colore testo */
  display: flex;                    /* flexbox */
  justify-content: center;          /* centra orizzontalmente */
  align-items: center;              /* centra verticalmente */
  font-weight: bold;                /* grassetto */
  font-size: 1.2rem;                /* dimensione font */
  flex-shrink: 0;                   /* non si riduce */
}

/* Dropdown menu utente (nascosto di default) */
.dropdown {
  position: absolute;               /* posizione assoluta */
  right: 0;                        /* ancorato a destra */
  top: 50px;                      /* sotto la nav */
  background: #333;                /* sfondo scuro */
  border-radius: 8px;             /* angoli arrotondati */
  box-shadow: 0 5px 15px rgba(0,0,0,0.5); /* ombra */
  display: none;                  /* nascosto */
  flex-direction: column;         /* elementi in colonna */
  min-width: 180px;               /* larghezza minima */
  z-index: 20;                   /* sopra nav */
  opacity: 0;                    /* trasparente */
  transform: translateY(-10px);  /* spostato leggermente in alto */
  transition: opacity var(--transition-speed) ease, transform var(--transition-speed) ease; /* transizioni */
  pointer-events: none;          /* non cliccabile quando nascosto */
}

/* Link all'interno del dropdown */
.dropdown a {
  color: var(--text-light);        /* colore testo chiaro */
  padding: 12px 16px;              /* padding interno */
  text-decoration: none;           /* rimuove sottolineatura */
  transition: background var(--transition-speed); /* transizione sfondo */
  font-weight: 600;                /* font medio/grassetto */
}

/* Effetto hover e focus su link dropdown */
.dropdown a:hover,
.dropdown a:focus {
  background: var(--accent-color); /* colore di accento */
  color: #000;                     /* testo nero */
  outline: none;                  /* nessun contorno */
}

/* Username mostrato nel dropdown, non cliccabile */
.dropdown-item.username-display {
  color: var(--text-light);        /* testo chiaro */
  padding: 12px 16px;              /* padding */
  font-weight: 600;                /* font medio */
  display: block;                  /* block per occupare tutta la larghezza */
  cursor: default;                /* cursore default */
  user-select: none;              /* non selezionabile */
  background: transparent;        /* sfondo trasparente */
}

/* Disabilita hover/focus sull'username per mantenere aspetto */
.dropdown-item.username-display:hover,
.dropdown-item.username-display:focus {
  background: transparent;        /* nessuno sfondo */
  color: var(--text-light);       /* colore testo invariato */
  outline: none;                  /* nessun outline */
}

/* Quando menu utente è aperto, mostra dropdown */
.user-menu.open .dropdown {
  display: flex;                  /* mostra come flex */
  opacity: 1;                    /* opacità piena */
  transform: translateY(0);      /* posizione originale */
  pointer-events: auto;          /* cliccabile */
}

/* Freccia dropdown */
.arrow {
  display: inline-block;           /* inline-block */
  margin-left: 6px;                /* margine sinistro */
  transition: transform var(--transition-speed) ease; /* transizione rotazione */
  font-size: 1.1rem;               /* dimensione font */
  user-select: none;               /* non selezionabile */
}

/* Ruota la freccia quando menu aperto */
.user-menu.open .arrow {
  transform: rotate(180deg);       /* ruota di 180 gradi */
}

/* ===== MAIN CONTENT ===== */

/* Padding e centratura contenuto principale */
main {
  padding: 40px 20px;              /* padding verticale e orizzontale */
  text-align: center;              /* testo centrato */
}

/* Titoli principali */
main h2 {
  font-weight: 700;                /* grassetto */
  margin-bottom: 20px;             /* spazio sotto */
}

/* ===== OVERLAY ===== */

/* Overlay semi-trasparente nascosto di default */
#overlay {
  position: fixed;                 /* posizione fissa */
  inset: 0;                       /* copre tutto (top,right,bottom,left 0) */
  background: rgba(0,0,0,0.6);    /* sfondo nero trasparente */
  z-index: 45;                    /* sopra altri elementi */
  display: none;                  /* nascosto */
  opacity: 0;                    /* invisibile */
  transition: opacity var(--transition-speed) ease; /* transizione opacità */
}

/* Overlay attivo visibile */
#overlay.active {
  display: block;                 /* mostra overlay */
  opacity: 1;                    /* piena opacità */
}

/* ===== POPUP PROFILO ===== */

/* Popup profilo centrato e nascosto di default */
#profilePopup {
  position: fixed;                 /* posizione fissa */
  top: 50%; left: 50%;            /* centro */
  transform: translate(-50%, -50%) scale(0.95); /* centrato e leggermente ridotto */
  background: var(--popup-bg);     /* colore di sfondo popup */
  color: var(--popup-color);       /* colore testo popup */
  padding: 25px 30px;              /* padding interno */
  border-radius: 12px;             /* angoli arrotondati */
  box-shadow: 0 5px 20px rgba(0,0,0,0.8); /* ombra profonda */
  z-index: 50;                    /* sopra overlay */
  width: 500px;                   /* larghezza fissa */
  max-width: 90vw;                /* massima larghezza viewport */
  display: none;                  /* nascosto */
  opacity: 0;                    /* trasparente */
  transition: opacity var(--transition-speed) ease, transform var(--transition-speed) ease; /* transizioni */
  outline: none;                 /* nessun contorno */
}

/* Mostra popup profilo */
#profilePopup.show {
  display: block;                /* mostra */
  opacity: 1;                   /* opacità piena */
  transform: translate(-50%, -50%) scale(1); /* scala normale */
}

/* Barra interna del popup */
#barra {
  position: relative;            /* posizionamento relativo */
  margin-bottom: 20px;           /* spazio sotto */
  border: solid;                 /* bordo solido */
  border-radius: 20px;           /* angoli arrotondati */
  padding: 10px;                 /* padding */
  text-align: center;            /* testo centrato */
  background: #000000;           /* sfondo nero */
}

/* Titolo barra con colore accento */
#barra h3 {
  margin: 0;                    /* nessun margine */
  color: var(--accent-color);   /* colore accento */
  font-size: 1.4rem;            /* dimensione font */
  user-select: none;            /* testo non selezionabile */
}

/* Bottone chiusura popup */
#closePopupBtn {
  margin-top: 0;                 /* nessun margine sopra */
  position: absolute;            /* posizione assoluta */
  background: none;
}

/* Bottoni principali */
button {
  grid-column: 1 / span 2;           /* Il pulsante occupa due colonne nella griglia */
  margin-top: 15px;                  /* Spazio sopra il pulsante */
  padding: 10px 0;                  /* Spaziatura interna verticale (alto e basso), niente orizzontale */
  background: var(--accent-color);  /* Colore di sfondo preso da una variabile CSS */
  border: none;                    /* Nessun bordo */
  border-radius: 8px;              /* Angoli arrotondati di 8px */
  font-weight: 700;                /* Testo in grassetto */
  color: #000;                    /* Colore del testo nero */
  font-size: 1.1rem;              /* Dimensione del testo leggermente più grande della dimensione base */
  cursor: pointer;                /* Cambia il cursore in "mano" al passaggio del mouse */
  transition: background var(--transition-speed); /* Transizione fluida del background basata sulla variabile velocità */
}

button:hover,
button:focus {
  background: var(--accent-hover); /* Cambia il colore di sfondo al passaggio del mouse o al focus */
  outline: none;                   /* Rimuove il bordo di default al focus */
}

#verifyPasswordBtn {
  padding: 0 16px;                 /* Spaziatura interna orizzontale di 16px, zero verticale */
  font-size: 0.9rem;               /* Testo un po' più piccolo */
  height: 40px;                    /* Altezza fissa di 40px */
  margin-top: 0;                   /* Nessuno spazio sopra */
  border-radius: 6px;              /* Angoli leggermente arrotondati */
  font-weight: 600;                /* Peso del font medio-grassetto */
  background: var(--accent-color); /* Sfondo con colore variabile */
  color: #000;                    /* Testo nero */
  transition: background var(--transition-speed); /* Transizione fluida del colore di sfondo */
}

#verifyPasswordBtn:hover,
#verifyPasswordBtn:focus {
  background: var(--accent-hover); /* Sfondo cambia colore al passaggio o focus */
  outline: none;                   /* Nessun bordo al focus */
}

/* Flex per vecchia password + bottone */
/* (qui manca codice, probabilmente serve aggiungere display:flex etc.) */

/* Nascondi password fields di default */
.hidden {
  display: none !important;       /* Nasconde l'elemento, forza la regola ignorando altre */
}

#changeUsernameBtn {
  padding: 0 16px;                 /* Spaziatura interna orizzontale */
  font-size: 0.9rem;               /* Dimensione testo */
  height: 40px;                    /* Altezza fissa */
  margin-top: 0;                   /* Nessun margine superiore */
  border-radius: 6px;              /* Angoli arrotondati */
  font-weight: 600;                /* Peso del font */
  background: var(--accent-color); /* Colore di sfondo */
  color: #000;                    /* Colore testo nero */
  transition: background var(--transition-speed); /* Transizione dello sfondo */
}

#changeUsernameBtn:hover {
  background: var(--accent-hover); /* Sfondo cambia al passaggio */
  outline: none;                   /* Nessun contorno al focus */
}

@media (max-width: 600px) {
  /* Layout form su schermi piccoli */
  form {
    display: flex;                 /* Usa flexbox */
    flex-direction: column;       /* Elementi in colonna */
    gap: 18px;                    /* Spaziatura tra gli elementi */
    width: 100%;                  /* Larghezza piena */
  }

  .form-group {
    display: flex;                /* Flex container */
    flex-direction: column;       /* Colonna */
    align-items: anchor-center;   /* (Nota: valore non valido CSS, forse intendevi center) */
    width: 100%;                  /* Larghezza piena */
  }

  .form-group label {
    width: 100%;                  /* Larghezza label piena */
    text-align: left;             /* Allineamento testo a sinistra */
    margin-bottom: 5px;           /* Spazio sotto la label */
    font-weight: 600;             /* Peso del font */
  }

  .form-group input {
    width: 100%;                  /* Input piena larghezza */
    margin-bottom: 10px;          /* Spazio sotto input */
  }

  .username-group, .old-password-group {
    display: flex;                /* Flex container */
    flex-direction: column;       /* Colonna */
    align-items: anchor-center;   /* (Stesso valore non valido) */
    width: 100%;                  /* Larghezza piena */
  }

  .username-group label, .old-password-group label {
    width: 100%;                  /* Label larghezza piena */
    text-align: left;             /* Testo a sinistra */
    margin-bottom: 5px;           /* Spazio sotto */
    font-weight: 600;             /* Peso font */
  }

  .username-group input, .old-password-group input {
    width: 100%;                  /* Input larga */
    margin-bottom: 10px;          /* Spazio sotto */
  }

  #changeUsernameBtn,
  #verifyPasswordBtn,
  button[type="submit"] {
    width: 100%;                  /* Pulsanti a tutta larghezza su mobile */
  }

  #barra {
    display: flex;                /* Flex container */
    justify-content: center;      /* Centra contenuto orizzontalmente */
    align-items: center;          /* Centra verticalmente */
    position: relative;           /* Posizione relativa */
    margin-bottom: 20px;          /* Spazio sotto la barra */
    background: #000000;          /* Sfondo nero */
  }

  #barra h3 {
    margin: 0 auto;               /* Margine orizzontale automatico (centratura) */
    color: var(--accent-color);  /* Colore testo variabile */
    font-size: 1.4rem;            /* Dimensione testo */
    text-align: center;           /* Testo centrato */
  }

  #profilePopup {
    max-height: 90vh;             /* Altezza massima 90% viewport height */
    overflow-y: auto;             /* Scroll verticale automatico se contenuto troppo alto */
    width: 95vw;                  /* Larghezza 95% viewport width */
    padding: 25px 20px;           /* Padding interno */
  }
}

@media (min-width: 601px) and (orientation: landscape) {
  form {
    display: flex;                /* Flex container */
    flex-direction: column;       /* Colonna */
    gap: 10px;                   /* Spaziatura minore tra elementi */
  }

  .form-group,
  .username-group,
  .old-password-group {
    display: flex;                /* Flex container */
    flex-direction: row;          /* In fila */
    align-items: center;          /* Allineamento verticale al centro */
    width: 100%;                  /* Larghezza piena */
  }

  .form-group label,
  .username-group label,
  .old-password-group label {
    font-weight: 600;             /* Peso del font */
    width: 25%;                  /* Label occupa il 25% della larghezza */
    text-align: left;             /* Testo a sinistra */
  }

  .form-group input,
  .username-group input,
  .old-password-group input {
    width: 100%;                  /* Input larga */
    margin-bottom: 0px;           /* Nessun margine sotto */
  }

  #changeUsernameBtn,
  #verifyPasswordBtn {
    width: 30%;                   /* Pulsanti più stretti */
    margin-top: 0;                /* Nessun margine sopra */
  }

  button[type="submit"] {
    width: 100%;                  /* Pulsante submit larga */
  }

  #profilePopup {
    max-height: 80vh;             /* Altezza massima ridotta */
    overflow-y: auto;             /* Scroll verticale */
    -webkit-overflow-scrolling: touch; /* Scroll fluido su iOS */
    width: 90vw;                  /* Larghezza minore rispetto a mobile */
    padding: 25px 20px;           /* Padding */
  }

  html, body {
    height: 90vh;                 /* Altezza massima viewport */
    overflow: auto;               /* Abilita scroll se necessario */
  }
}
